WITH  
Q1 AS (SELECT 3 + 5 S FROM DUAL),  
    Q2 AS (SELECT 3 * 5 M FROM DUAL),  
    Q3 AS (SELECT S, M, S + M, S * M FROM Q1, Q2)  
SELECT * FROM Q3;		
			
SELECT TO_CHAR(T1.REPORT_DATE,'YYYY-MM') TIME,COUNT(*) COUNT
FROM FAC_PRODUCE_ALGAEWATER T1
GROUP BY TO_CHAR(T1.REPORT_DATE,'YYYY-MM')
ORDER BY TO_CHAR(T1.REPORT_DATE,'YYYY-MM') ASC NULLS  LAST

select table_name from user_tab_columns where data_type in ('CLOB')

WITH  
Q1 AS (
SELECT T2.GRAINATTRNAME,T3.GRAINNAME,ROUND(SUM(T1.REALTIMEQTY),2),ROUND(SUM(T1.AUDITNUMBER),2),TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD'),T6.PROVINCENAME,T7.CITYNAME,T8.COUNTYNAME,T5.GRAINDEPOTNAME,T9.STORAGENAME FROM M_ONSTORAGE T1 LEFT JOIN L_GRAINATTR T2 ON T1.GRAINATTRID=T2.GRAINATTRID LEFT JOIN L_GRAIN T3 ON T1.GRAINID=T3.GRAINID LEFT JOIN L_GRAINDEPOT T5 ON T1.GRAINDEPOTID=T5.GRAINDEPOTID LEFT JOIN L_PROVINCE T6 ON T5.PROVINCEID=T6.PROVINCEID LEFT JOIN L_CITY T7 ON T5.CITYID=T7.CITYID LEFT JOIN L_COUNTY T8 ON T5.COUNTYID=T8.COUNTYID LEFT JOIN L_STORAGE T9 ON T1.STORAGEID=T9.STORAGEID WHERE T5.CLOSED=0
 GROUP BY T2.GRAINATTRNAME,T3.GRAINNAME,TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD'),T6.PROVINCENAME,T7.CITYNAME,T8.COUNTYNAME,T5.GRAINDEPOTNAME,T9.STORAGENAME
 )
 select q1.*,rownum from q1
SELECT T2.GRAINATTRNAME,T3.GRAINNAME,T5.GRAINDEPOTNAME,TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD'),T6.PROVINCENAME,T7.CITYNAME,T8.RANKNAME,SUM(T1.GROSSWEIGHT),SUM(T1.TARE),SUM(T1.NETWEIGHT),SUM(T1.DEDUWEIGHT),SUM(T1.PAIDWEIGHT),SUM(T1.PRICE),SUM(T1.AMOUNT),T9.COUNTYNAME FROM B_SAINOUT T1 LEFT JOIN L_GRAINATTR T2 ON T1.GRAINATTRID=T2.GRAINATTRID LEFT JOIN L_GRAIN T3 ON T1.GRAINID=T3.GRAINID LEFT JOIN L_GRAINDEPOT T5 ON T1.GRAINDEPOTID=T5.GRAINDEPOTID LEFT JOIN L_PROVINCE T6 ON T5.PROVINCEID=T6.PROVINCEID LEFT JOIN L_CITY T7 ON T5.CITYID=T7.CITYID LEFT JOIN L_RANK T8 ON T1.RANKID=T8.RANKID LEFT JOIN L_COUNTY T9 ON T9.COUNTYID=T5.COUNTYID WHERE T5.CLOSED=0
GROUP BY T2.GRAINATTRNAME,T3.GRAINNAME,T5.GRAINDEPOTNAME,TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD'),T6.PROVINCENAME,T7.CITYNAME,T8.RANKNAME,T9.COUNTYNAME ORDER BY TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD') DESC
and APPRAISALDATE=to_date(TO_CHAR(LAST_DAY(ADD_MONTHS(LAST_DAY(SYSDATE) + 1, -1)),'yyyy/MM/dd'),'yyyy-mm-dd hh24:mi:ss')

