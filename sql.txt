WITH  
Q1 AS (SELECT 3 + 5 S FROM DUAL),  
    Q2 AS (SELECT 3 * 5 M FROM DUAL),  
    Q3 AS (SELECT S, M, S + M, S * M FROM Q1, Q2)  
SELECT * FROM Q3;


insert into DIM_NODE (NODE_ID,NODE_NAME) values(SEQ_DIM_NODE.nextval,232)

exp admin/admin@863 file=d:\daochu.dmp owner=(ADMIN)


String queryString = "select distinct DIM_Node.NODE_NAME,DIM_WARNING_LEVEL.LEVEL_NAME,DIM_MONI_ITEM.MONI_ITEM_NAME,FAC_WATER_WARNING.WARNING_TIME "
			+ "from FAC_WATER_WARNING,DIM_Node,DIM_WARNING_LEVEL,DIM_WARNING_LIMIT,DIM_MONI_ITEM"
			+ "where FAC_WATER_WARNING.NODE_ID=DIM_Node.NODE_ID(+)"
			+ "and FAC_WATER_WARNING.MONI_ITEM_ID=DIM_MONI_ITEM.MONI_ITEM_ID(+)"
			+ "and FAC_WATER_WARNING.WARNING_LEVEL_ID=DIM_WARNING_LEVEL.WARNING_LEVEL_ID"
			+ "and FAC_WATER_WARNING.WARNING_LIMIT_ID=DIM_WARNING_LIMIT.id"
			+ "and DIM_Node.is_closed = 0 ORDER BY NLSSORT(NODE_NAME, 'NLS_SORT=SCHINESE_PINYIN_M')";
			
			
			
SELECT TO_CHAR(T1.REPORT_DATE,'YYYY-MM') TIME,COUNT(*) COUNT
FROM FAC_PRODUCE_ALGAEWATER T1
GROUP BY TO_CHAR(T1.REPORT_DATE,'YYYY-MM')
ORDER BY TO_CHAR(T1.REPORT_DATE,'YYYY-MM') ASC NULLS  LAST

select table_name from user_tab_columns where data_type in ('CLOB')

exp szla/123456@SZLA file=d:\20140509.dmp
 full=y
exp szla/ictehi@SZLA file=d:\20140526.dmp

exp graindc/ictehi@GRAINDC file=d:\20140616.dmp

select t2.GRAINATTRNAME,T3.GRAINNAME,T4.STORAGENAME,T5.GRAINDEPOTNAME,t1.REALTIMEQTY,t1.TIME_STAMP,T6.PROVINCENAME,T7.CITYNAME,T8.COUNTYNAME
from M_ONSTORAGE t1 left join L_GRAINATTR t2 on t1.GRAINATTRID=t2.GRAINATTRID
left join L_GRAIN t3 on T1.GRAINID=t3.GRAINID 
left join L_STORAGE t4 on t1.STORAGEID=t4.STORAGEID
left join L_GRAINDEPOT t5 on T1.GRAINDEPOTID=T5.GRAINDEPOTID
left join L_PROVINCE t6 on t5.PROVINCEID=t6.PROVINCEID
left join L_CITY t7 on t5.CITYID=t7.CITYID
left join L_COUNTY t8 on t5.COUNTYID=t8.COUNTYID

WITH  
Q1 AS (
SELECT T2.GRAINATTRNAME,T3.GRAINNAME,ROUND(SUM(T1.REALTIMEQTY),2),ROUND(SUM(T1.AUDITNUMBER),2),TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD'),T6.PROVINCENAME,T7.CITYNAME,T8.COUNTYNAME,T5.GRAINDEPOTNAME,T9.STORAGENAME FROM M_ONSTORAGE T1 LEFT JOIN L_GRAINATTR T2 ON T1.GRAINATTRID=T2.GRAINATTRID LEFT JOIN L_GRAIN T3 ON T1.GRAINID=T3.GRAINID LEFT JOIN L_GRAINDEPOT T5 ON T1.GRAINDEPOTID=T5.GRAINDEPOTID LEFT JOIN L_PROVINCE T6 ON T5.PROVINCEID=T6.PROVINCEID LEFT JOIN L_CITY T7 ON T5.CITYID=T7.CITYID LEFT JOIN L_COUNTY T8 ON T5.COUNTYID=T8.COUNTYID LEFT JOIN L_STORAGE T9 ON T1.STORAGEID=T9.STORAGEID WHERE T5.CLOSED=0
 GROUP BY T2.GRAINATTRNAME,T3.GRAINNAME,TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD'),T6.PROVINCENAME,T7.CITYNAME,T8.COUNTYNAME,T5.GRAINDEPOTNAME,T9.STORAGENAME
 )
 select q1.*,rownum from q1
SELECT T2.GRAINATTRNAME,T3.GRAINNAME,T5.GRAINDEPOTNAME,TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD'),T6.PROVINCENAME,T7.CITYNAME,T8.RANKNAME,SUM(T1.GROSSWEIGHT),SUM(T1.TARE),SUM(T1.NETWEIGHT),SUM(T1.DEDUWEIGHT),SUM(T1.PAIDWEIGHT),SUM(T1.PRICE),SUM(T1.AMOUNT),T9.COUNTYNAME FROM B_SAINOUT T1 LEFT JOIN L_GRAINATTR T2 ON T1.GRAINATTRID=T2.GRAINATTRID LEFT JOIN L_GRAIN T3 ON T1.GRAINID=T3.GRAINID LEFT JOIN L_GRAINDEPOT T5 ON T1.GRAINDEPOTID=T5.GRAINDEPOTID LEFT JOIN L_PROVINCE T6 ON T5.PROVINCEID=T6.PROVINCEID LEFT JOIN L_CITY T7 ON T5.CITYID=T7.CITYID LEFT JOIN L_RANK T8 ON T1.RANKID=T8.RANKID LEFT JOIN L_COUNTY T9 ON T9.COUNTYID=T5.COUNTYID WHERE T5.CLOSED=0
GROUP BY T2.GRAINATTRNAME,T3.GRAINNAME,T5.GRAINDEPOTNAME,TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD'),T6.PROVINCENAME,T7.CITYNAME,T8.RANKNAME,T9.COUNTYNAME ORDER BY TO_CHAR(T1.TIME_STAMP,'YYYY-MM-DD') DESC
and APPRAISALDATE=to_date(TO_CHAR(LAST_DAY(ADD_MONTHS(LAST_DAY(SYSDATE) + 1, -1)),'yyyy/MM/dd'),'yyyy-mm-dd hh24:mi:ss')

